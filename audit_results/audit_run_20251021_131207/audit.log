ğŸ“ Audit run directory: audit_results/audit_run_20251021_131207
ğŸ“ Logs will be saved to: audit_results/audit_run_20251021_131207/audit.log

======================================================================
ğŸ” Auditing table: blocks
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
âœ… Connected to BIGQUERY
ğŸ”– Table UID: bigquery-public-data.crypto_bitcoin.blocks
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 920,092 rows
ğŸ”‘ Primary key from config: block_id
ğŸ“ Using custom query - will count rows from query result
â„¹ï¸  Custom query provided - using query as-is (no additional sampling)
âœ… Loaded 2,000 rows into memory
ğŸ“Š Custom query returned 2,000 rows

============================================================
Auditing: blocks
Total rows in table: 2,000
============================================================

ğŸ”’ Closed BIGQUERY connection
âŒ Error auditing table 'blocks': `hour` operation not supported for dtype `date`
Traceback (most recent call last):
  File "/Users/v/Documents/GitHub/database_audit/audit.py", line 129, in main
    results = auditor.audit_from_database(
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 258, in audit_from_database
    results = self.audit_table(
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/core/auditor.py", line 435, in audit_table
    insights = generate_column_insights(df, col, col_insights_config)
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/insights/column_insights.py", line 57, in generate_column_insights
    return generate_datetime_insights(df, col, config)
  File "/Users/v/Documents/GitHub/database_audit/dw_auditor/insights/datetime_insights.py", line 80, in generate_datetime_insights
    .with_columns(pl.col(col).dt.hour().alias('hour'))
  File "/Users/v/Documents/GitHub/database_audit/audit_env/lib/python3.10/site-packages/polars/dataframe/frame.py", line 10170, in with_columns
    self.lazy()
  File "/Users/v/Documents/GitHub/database_audit/audit_env/lib/python3.10/site-packages/polars/_utils/deprecation.py", line 97, in wrapper
    return function(*args, **kwargs)
  File "/Users/v/Documents/GitHub/database_audit/audit_env/lib/python3.10/site-packages/polars/lazyframe/opt_flags.py", line 328, in wrapper
    return function(*args, **kwargs)
  File "/Users/v/Documents/GitHub/database_audit/audit_env/lib/python3.10/site-packages/polars/lazyframe/frame.py", line 2415, in collect
    return wrap_df(ldf.collect(engine, callback))
polars.exceptions.InvalidOperationError: `hour` operation not supported for dtype `date`

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251021_131207
â±ï¸  Total duration: 12.73 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251021_131207/audit.log
======================================================================
