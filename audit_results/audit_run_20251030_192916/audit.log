ğŸ“ Audit run directory: audit_results/audit_run_20251030_192916
ğŸ“ Logs will be saved to: audit_results/audit_run_20251030_192916/audit.log
ğŸ” Full audit mode: Running quality checks and profiling/insights

======================================================================
ğŸ’° Estimating BigQuery scan costs...
======================================================================
âœ… Connected to BIGQUERY

ğŸ” Pre-fetching metadata for 2 table(s)...
âœ… Metadata cached for all tables
   ğŸ“Š fct_avaibility_part: Estimating 14 columns: station_code, station_name, capacity, docks_available, mechanical...
   ğŸ” Estimating query: SELECT station_code, station_name, capacity, docks_available, mechanical, ebike, duedate, bikes_available, rate_bike_available, rate_dock_available, bikes_out_of_order, collected_at, rounded_collected...
   ğŸ“Š dim_station: Estimating 9 columns: station_code, station_name, capacity, lon, lat...
   ğŸ” Estimating query: SELECT station_code, station_name, capacity, lon, lat, city, is_renting, is_returning, station_plus FROM `dbt_prod.dim_station`

ğŸ“Š Estimated bytes to scan per table:
   â€¢ fct_avaibility_part: 489.91 MB (sampled)
   â€¢ dim_station: 112.29 KB

ğŸ’¾ Total estimated data to scan: 0.49 GB (0.0005 TB)
ğŸ’µ Estimated cost (on-demand): $0.00 USD

âš ï¸  Do you want to proceed with the audit?
   Type 'y' or 'yes' to continue, or 'n' to cancel: 
âš ï¸  Running in non-interactive mode, proceeding with audit...
   (Use --yes flag in future to skip this prompt)

âœ… Proceeding with audit...

======================================================================
ğŸ” Auditing table: fct_avaibility_part
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
ğŸ”– Table UID: portfolio-402.dbt_prod.fct_avaibility_part
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 3,877,353 rows
ğŸ”¹ Partitioned by: collected_at (TIME)
ğŸ”¸ Clustered by: station_code
ğŸ“Š Optimized column loading: selecting 14/14 columns
ğŸ” Sampling 10,000 rows from table using 'random' method
âœ… Loaded 10,000 rows into memory

============================================================
Auditing: fct_avaibility_part
Total rows in table: 3,877,353
Analyzing sample: 10,000 rows
============================================================


ğŸ”„ Attempting type conversions on 2 string column(s)...
   âœ“ test_convert: string â†’ int64 (100.0% success)
âœ… Successfully converted 1 column(s) to more specific types


ğŸ“‹ Column Summary (All Columns):
===================================================================================================================
Column Name                    Type                           Status       Nulls           Distinct       
-------------------------------------------------------------------------------------------------------------------
station_code                   int64                          - NO_CHECKS  0 (0.0%)        1,459          
station_name                   string                         âœ— ERROR      0 (0.0%)        1,456          
capacity                       int64                          - NO_CHECKS  0 (0.0%)        66             
docks_available                int64                          - NO_CHECKS  0 (0.0%)        69             
mechanical                     int64                          - NO_CHECKS  0 (0.0%)        64             
ebike                          int64                          - NO_CHECKS  0 (0.0%)        36             
duedate                        datetime(time_unit='ns', time_zone='utc') âœ“ OK         0 (0.0%)        9,933          
bikes_available                int64                          âœ— ERROR      0 (0.0%)        74             
rate_bike_available            float64                        - NO_CHECKS  0 (0.0%)        1,023          
rate_dock_available            float64                        - NO_CHECKS  0 (0.0%)        1,041          
bikes_out_of_order             int64                          - NO_CHECKS  0 (0.0%)        44             
collected_at                   datetime(time_unit='ns', time_zone=none) âœ“ OK         0 (0.0%)        2,621          
rounded_collected_at           datetime(time_unit='ns', time_zone=none) âœ“ OK         0 (0.0%)        2,621          
test_convert                   string â†’ int64                 - NO_CHECKS  0 (0.0%)        66             
===================================================================================================================


ğŸ’¡ Column Insights:

ğŸ“Š station_code:
   Top 5 Values:
      â€¢ '12127.0' (16x, 0.2%)
      â€¢ '22408.0' (16x, 0.2%)
      â€¢ '35017.0' (15x, 0.1%)
      â€¢ '17041.0' (15x, 0.1%)
      â€¢ '11019.0' (14x, 0.1%)
   Stats: min=1001.00, max=92008.00, mean=18904.20, median=16138.00
   Quantiles: p25=11044.00, p50=16138.00, p75=22203.00, p90=40002.00

ğŸ“Š station_name:
   Top 10 Values:
      â€¢ 'Place Nelson Mandela' (18x, 0.2%)
      â€¢ 'Tremblay - Lac des Minimes' (16x, 0.2%)
      â€¢ 'Place du 14 Juillet' (16x, 0.2%)
      â€¢ 'Toffier Decaux - Cartier Bresson' (15x, 0.1%)
      â€¢ 'Guersant - Gouvion-Saint-Cyr' (15x, 0.1%)
      â€¢ 'Charonne - Philippe-Auguste' (14x, 0.1%)
      â€¢ 'Duroc - Place de Breteuil' (14x, 0.1%)
      â€¢ 'Redoute - Les Courtilles' (14x, 0.1%)
      â€¢ 'Roquette - Folie Regnault' (14x, 0.1%)
      â€¢ 'Place de la Gare' (14x, 0.1%)
   Length: min=6, max=50, avg=23.82

ğŸ“Š capacity:
   Top 5 Values:
      â€¢ '30.0' (601x, 6.0%)
      â€¢ '20.0' (517x, 5.2%)
      â€¢ '28.0' (468x, 4.7%)
      â€¢ '25.0' (454x, 4.5%)
      â€¢ '24.0' (439x, 4.4%)
   Stats: min=8.00, max=78.00, mean=32.12, median=30.00
   Quantiles: p25=23.00, p50=30.00, p75=38.00, p90=50.00

ğŸ“Š docks_available:
   Top 5 Values:
      â€¢ '15.0' (384x, 3.8%)
      â€¢ '18.0' (381x, 3.8%)
      â€¢ '16.0' (373x, 3.7%)
      â€¢ '17.0' (362x, 3.6%)
      â€¢ '19.0' (345x, 3.5%)
   Stats: min=0.00, max=75.00, mean=19.42, median=18.00
   Quantiles: p25=10.00, p50=18.00, p75=27.00, p90=36.00

ğŸ“Š mechanical:
   Top 5 Values:
      â€¢ '0.0' (1,742x, 17.4%)
      â€¢ '1.0' (1,318x, 13.2%)
      â€¢ '2.0' (950x, 9.5%)
      â€¢ '3.0' (720x, 7.2%)
      â€¢ '4.0' (596x, 6.0%)
   Stats: min=0.00, max=69.00, mean=7.24, median=4.00
   Quantiles: p25=1.00, p50=4.00, p75=10.00, p90=19.00

ğŸ“Š ebike:
   Top 5 Values:
      â€¢ '2.0' (1,585x, 15.8%)
      â€¢ '1.0' (1,520x, 15.2%)
      â€¢ '3.0' (1,357x, 13.6%)
      â€¢ '4.0' (1,096x, 11.0%)
      â€¢ '0.0' (877x, 8.8%)
   Stats: min=0.00, max=39.00, mean=4.35, median=3.00
   Quantiles: p25=2.00, p50=3.00, p75=6.00, p90=10.00

ğŸ“Š duedate:
   Date Range: from 2025-06-30 19:15:37+00:00 to 2025-10-21 22:50:25+00:00 (113 days)
   Timezone: UTC
   Most Common Dates:
      â€¢ 2025-09-26 (113x, 1.1%)
      â€¢ 2025-09-27 (111x, 1.1%)
      â€¢ 2025-08-10 (110x, 1.1%)
      â€¢ 2025-09-01 (108x, 1.1%)
      â€¢ 2025-08-30 (107x, 1.1%)
   Most Common Days of Week:
      â€¢ Tuesday (1,491x, 14.9%)
      â€¢ Wednesday (1,451x, 14.5%)
      â€¢ Thursday (1,441x, 14.4%)
      â€¢ Sunday (1,419x, 14.2%)
      â€¢ Friday (1,412x, 14.1%)
      â€¢ Saturday (1,398x, 14.0%)
      â€¢ Monday (1,388x, 13.9%)
   Most Common Hours:
      â€¢ 02:00 (475x, 4.8%)
      â€¢ 23:00 (461x, 4.6%)
      â€¢ 17:00 (449x, 4.5%)
      â€¢ 15:00 (437x, 4.4%)
      â€¢ 20:00 (436x, 4.4%)

ğŸ“Š bikes_available:
   Top 5 Values:
      â€¢ '3.0' (723x, 7.2%)
      â€¢ '4.0' (674x, 6.7%)
      â€¢ '2.0' (660x, 6.6%)
      â€¢ '5.0' (595x, 5.9%)
      â€¢ '1.0' (572x, 5.7%)
   Stats: min=0.00, max=76.00, mean=11.59, median=9.00
   Quantiles: p25=4.00, p50=9.00, p75=16.00, p90=25.00

ğŸ“Š rate_bike_available:
   Top 5 Values:
      â€¢ '0.0' (250x, 2.5%)
      â€¢ '0.5' (163x, 1.6%)
      â€¢ '0.25' (154x, 1.5%)
      â€¢ '0.2' (140x, 1.4%)
      â€¢ '0.1' (137x, 1.4%)
   Stats: min=0.00, max=1.62, mean=0.37, median=0.29
   Quantiles: p25=0.13, p50=0.29, p75=0.56, p90=0.81

ğŸ“Š rate_dock_available:
   Top 5 Values:
      â€¢ '0.0' (195x, 1.9%)
      â€¢ '0.5' (192x, 1.9%)
      â€¢ '0.75' (159x, 1.6%)
      â€¢ '1.0' (149x, 1.5%)
      â€¢ '0.6666666666666666' (147x, 1.5%)
   Stats: min=0.00, max=1.00, mean=0.60, median=0.67
   Quantiles: p25=0.39, p50=0.67, p75=0.83, p90=0.92

ğŸ“Š bikes_out_of_order:
   Top 5 Values:
      â€¢ '0.0' (4,180x, 41.8%)
      â€¢ '1.0' (3,029x, 30.3%)
      â€¢ '2.0' (1,499x, 15.0%)
      â€¢ '3.0' (664x, 6.6%)
      â€¢ '4.0' (271x, 2.7%)
   Stats: min=-28.00, max=34.00, mean=1.11, median=1.00
   Quantiles: p25=0.00, p50=1.00, p75=2.00, p90=3.00

ğŸ“Š collected_at:
   Date Range: from 2025-07-01 00:06:03 to 2025-10-22 02:06:09 (113 days)
   Timezone: None (timezone-naive)
   Most Common Dates:
      â€¢ 2025-10-16 (111x, 1.1%)
      â€¢ 2025-09-26 (110x, 1.1%)
      â€¢ 2025-09-01 (109x, 1.1%)
      â€¢ 2025-07-20 (107x, 1.1%)
      â€¢ 2025-09-27 (107x, 1.1%)
   Most Common Days of Week:
      â€¢ Tuesday (1,474x, 14.7%)
      â€¢ Wednesday (1,469x, 14.7%)
      â€¢ Friday (1,455x, 14.5%)
      â€¢ Sunday (1,432x, 14.3%)
      â€¢ Thursday (1,407x, 14.1%)
      â€¢ Monday (1,394x, 13.9%)
      â€¢ Saturday (1,369x, 13.7%)
   Most Common Hours:
      â€¢ 07:00 (470x, 4.7%)
      â€¢ 03:00 (450x, 4.5%)
      â€¢ 20:00 (445x, 4.5%)
      â€¢ 06:00 (437x, 4.4%)
      â€¢ 05:00 (432x, 4.3%)

ğŸ“Š rounded_collected_at:
   Date Range: from 2025-07-01 00:00:00 to 2025-10-22 02:00:00 (113 days)
   Timezone: None (timezone-naive)
   Most Common Dates:
      â€¢ 2025-10-16 (111x, 1.1%)
      â€¢ 2025-09-26 (110x, 1.1%)
      â€¢ 2025-09-01 (109x, 1.1%)
      â€¢ 2025-07-20 (107x, 1.1%)
      â€¢ 2025-09-27 (107x, 1.1%)
   Most Common Days of Week:
      â€¢ Tuesday (1,474x, 14.7%)
      â€¢ Wednesday (1,469x, 14.7%)
      â€¢ Friday (1,455x, 14.5%)
      â€¢ Sunday (1,432x, 14.3%)
      â€¢ Thursday (1,407x, 14.1%)
      â€¢ Monday (1,394x, 13.9%)
      â€¢ Saturday (1,369x, 13.7%)
   Most Common Hours:
      â€¢ 07:00 (470x, 4.7%)
      â€¢ 03:00 (450x, 4.5%)
      â€¢ 20:00 (445x, 4.5%)
      â€¢ 06:00 (437x, 4.4%)
      â€¢ 05:00 (432x, 4.3%)

ğŸ“Š test_convert:
   Top 5 Values:
      â€¢ '30.0' (601x, 6.0%)
      â€¢ '20.0' (517x, 5.2%)
      â€¢ '28.0' (468x, 4.7%)
      â€¢ '25.0' (454x, 4.5%)
      â€¢ '24.0' (439x, 4.4%)
   Stats: min=8.00, max=78.00, mean=32.12, median=30.00
   Quantiles: p25=23.00, p50=30.00, p75=38.00, p90=50.00

ğŸ” Issues Found:

ğŸ“Š Column: station_name (string)
   Nulls: 0 (0.0%)
   Distinct values: 1,456
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']

ğŸ“Š Column: bikes_available (int64)
   Nulls: 0 (0.0%)
   Distinct values: 74
   âš ï¸  VALUES NOT GREATER THAN: 250 rows (2.5%)
      Expected: value > 0.0
      ğŸ’¡ Values should be > 0.0
      Examples: ['0', '0', '0', '0', '0']


â±ï¸  Audit Duration Breakdown:
   â€¢ numeric_checks: 0.007s
   â€¢ string_checks: 0.026s
   â€¢ date_checks: 0.010s
   â€¢ Total: 0.13s


â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.000s
   â€¢ Metadata: 0.010s
   â€¢ Column Selection: 0.000s
   â€¢ Data Loading: 4.459s
   â€¢ Audit Checks: 0.131s
   â€¢ Total Table Audit: 4.60s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251030_192916/fct_avaibility_part/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251030_192916/fct_avaibility_part/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251030_192916/fct_avaibility_part/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251030_192916/fct_avaibility_part/summary.csv

======================================================================
ğŸ” Auditing table: dim_station
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
ğŸ”– Table UID: portfolio-402.dbt_prod.dim_station
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 1,587 rows
ğŸ”‘ Primary key from config: station_code
ğŸ“Š Optimized column loading: selecting 9/9 columns
âœ… Loaded 1,587 rows into memory

============================================================
Auditing: dim_station
Total rows in table: 1,587
============================================================


ğŸ”„ Attempting type conversions on 2 string column(s)...
â„¹ï¸  No string columns could be converted (threshold: 95%)


ğŸ”‘ Potential primary key column(s): station_code, lat

ğŸ“‹ Column Summary (All Columns):
===================================================================================================================
Column Name                    Type                           Status       Nulls           Distinct       
-------------------------------------------------------------------------------------------------------------------
station_code                   int64                          âœ“ OK         0 (0.0%)        1,587          
station_name                   string                         âœ— ERROR      0 (0.0%)        1,570          
capacity                       int64                          âœ— ERROR      0 (0.0%)        72             
lon                            float64                        - NO_CHECKS  0 (0.0%)        1,586          
lat                            float64                        - NO_CHECKS  0 (0.0%)        1,587          
city                           string                         âœ“ OK         0 (0.0%)        68             
is_renting                     boolean                        - NOT_CHECKED 0 (0.0%)        2              
is_returning                   boolean                        - NOT_CHECKED 0 (0.0%)        2              
station_plus                   boolean                        - NOT_CHECKED 0 (0.0%)        2              
===================================================================================================================


ğŸ’¡ Column Insights:

ğŸ“Š station_code:
   Top 5 Values:
      â€¢ '11046.0' (1x, 0.1%)
      â€¢ '16015.0' (1x, 0.1%)
      â€¢ '40015.0' (1x, 0.1%)
      â€¢ '40006.0' (1x, 0.1%)
      â€¢ '16021.0' (1x, 0.1%)
   Stats: min=1001.00, max=92008.00, mean=19021.43, median=17007.00
   Quantiles: p25=11042.00, p50=17007.00, p75=22304.00, p90=40002.00

ğŸ“Š station_name:
   Top 10 Values:
      â€¢ 'Place des Marseillais' (2x, 0.1%)
      â€¢ 'Evariste Galois' (2x, 0.1%)
      â€¢ 'Gare RER - Canadiens' (2x, 0.1%)
      â€¢ 'Gaston Roussel - Commune de Paris' (2x, 0.1%)
      â€¢ 'RenÃ© Boulanger - Lancry' (2x, 0.1%)
      â€¢ 'Place Nelson Mandela' (2x, 0.1%)
      â€¢ 'Verdun - Carnot' (2x, 0.1%)
      â€¢ 'Paul Bodin - Clichy' (2x, 0.1%)
      â€¢ 'RÃ©aumur - Montmartre' (2x, 0.1%)
      â€¢ 'Place de la Gare' (2x, 0.1%)
   Length: min=6, max=58, avg=23.88

ğŸ“Š capacity:
   Top 5 Values:
      â€¢ '30.0' (93x, 5.9%)
      â€¢ '20.0' (82x, 5.2%)
      â€¢ '28.0' (72x, 4.5%)
      â€¢ '25.0' (68x, 4.3%)
      â€¢ '0.0' (66x, 4.2%)
   Stats: min=0.00, max=1200.00, mean=31.57, median=29.00
   Quantiles: p25=22.00, p50=29.00, p75=37.00, p90=50.00

ğŸ“Š lon:
   Top 5 Values:
      â€¢ '2.4345204234123234' (2x, 0.1%)
      â€¢ '2.280449643731117' (1x, 0.1%)
      â€¢ '2.3936596512794' (1x, 0.1%)
      â€¢ '2.3348518833518' (1x, 0.1%)
      â€¢ '2.404957212224' (1x, 0.1%)
   Stats: min=2.17, max=2.54, mean=2.34, median=2.34
   Quantiles: p25=2.30, p50=2.34, p75=2.38, p90=2.41

ğŸ“Š lat:
   Top 5 Values:
      â€¢ '48.850458009188' (1x, 0.1%)
      â€¢ '48.83059564231877' (1x, 0.1%)
      â€¢ '48.8071937956922' (1x, 0.1%)
      â€¢ '48.829654975522' (1x, 0.1%)
      â€¢ '48.84461063309956' (1x, 0.1%)
   Stats: min=48.76, max=48.96, mean=48.86, median=48.86
   Quantiles: p25=48.84, p50=48.86, p75=48.88, p90=48.90

ğŸ“Š city:
   Top 10 Values:
      â€¢ 'Paris' (1,056x, 66.5%)
      â€¢ 'Boulogne-Billancourt' (29x, 1.8%)
      â€¢ 'Montreuil' (24x, 1.5%)
      â€¢ 'Issy-les-Moulineaux' (22x, 1.4%)
      â€¢ 'Saint-Denis' (22x, 1.4%)
      â€¢ 'Pantin' (21x, 1.3%)
      â€¢ 'Ivry-sur-Seine' (18x, 1.1%)
      â€¢ 'Vitry-sur-Seine' (17x, 1.1%)
      â€¢ 'Neuilly-sur-Seine' (16x, 1.0%)
      â€¢ 'CrÃ©teil' (16x, 1.0%)
   Length: min=5, max=21, avg=7.4

ğŸ” Issues Found:

ğŸ“Š Column: station_name (string)
   Nulls: 0 (0.0%)
   Distinct values: 1,570
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'place du gÃ©nÃ©ral de gaulle' â†’ ['Place Du GÃ©nÃ©ral De Gaulle', 'Place du GÃ©nÃ©ral de Gaulle']

ğŸ“Š Column: capacity (int64)
   Nulls: 0 (0.0%)
   Distinct values: 72
   âš ï¸  VALUES NOT LESS THAN: 1,359 rows (85.6%)
      Expected: value < 20.0
      ğŸ’¡ Values should be < 20.0
      Examples: ['22 [station_code=1002]', '43 [station_code=1003]', '33 [station_code=1006]', '32 [station_code=1008]', '22 [station_code=1012]']


â±ï¸  Audit Duration Breakdown:
   â€¢ numeric_checks: 0.008s
   â€¢ string_checks: 0.015s
   â€¢ Total: 0.05s


â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.000s
   â€¢ Metadata: 0.001s
   â€¢ Column Selection: 0.000s
   â€¢ Data Loading: 2.819s
   â€¢ Audit Checks: 0.056s
   â€¢ Total Table Audit: 2.88s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251030_192916/dim_station/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251030_192916/dim_station/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251030_192916/dim_station/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251030_192916/dim_station/summary.csv

======================================================================
ğŸ”— Detecting table relationships...
======================================================================
   Added table: fct_avaibility_part
   Added table: dim_station

âœ… Found 3 relationships (confidence >= 70%)

Detected Relationships:
   â€¢ fct_avaibility_part.station_name â†’ dim_station.station_name
     Confidence: 97.1% | Type: many-to-one | Matching values: 1456
   â€¢ fct_avaibility_part.station_code â†’ dim_station.station_code
     Confidence: 96.8% | Type: many-to-one | Matching values: 1459
   â€¢ fct_avaibility_part.capacity â†” dim_station.capacity
     Confidence: 95.6% | Type: many-to-many | Matching values: 65

======================================================================
ğŸ“Š Generating run summary reports...
======================================================================
ğŸ“„ Summary HTML saved to: audit_results/audit_run_20251030_192916/summary.html
   â””â”€ Includes interactive relationship diagram with 3 relationship(s)
ğŸŒ Opened summary report in browser
ğŸ“„ Summary JSON saved to: audit_results/audit_run_20251030_192916/summary.json
ğŸ“„ Detailed column summary CSV saved to: audit_results/audit_run_20251030_192916/columns.csv
ğŸ“„ Table summary CSV saved to: audit_results/audit_run_20251030_192916/tables.csv
ğŸ“„ Relationships CSV saved to: audit_results/audit_run_20251030_192916/relationships.csv

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251030_192916
â±ï¸  Total duration: 30.54 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251030_192916/audit.log
======================================================================
ğŸ”’ Closed BIGQUERY connection
