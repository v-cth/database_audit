ğŸ“ Audit run directory: audit_results/audit_run_20251030_133528
ğŸ“ Logs will be saved to: audit_results/audit_run_20251030_133528/audit.log
ğŸ” Full audit mode: Running quality checks and profiling/insights

ğŸ” Auto-discovering tables in schema...
âœ… Connected to SNOWFLAKE (username/password)
âš ï¸  Could not fetch primary keys: 002003 (42S02): SQL compilation error:
Object 'SF_TRIAL.INFORMATION_SCHEMA.KEY_COLUMN_USAGE' does not exist or not authorized.
ğŸ“‹ Found 7 tables in schema
ğŸ”½ Filtered out 5 tables based on patterns
âœ… Will audit 2 tables
   Excluded: CAR_SALES, JSON_CONTENT, TABLE_CONFIG, XML_CONTENT, XML_CONTENT_2
ğŸ”’ Closed SNOWFLAKE connection
âœ… Connected to SNOWFLAKE (username/password)

ğŸ” Pre-fetching metadata for 2 table(s)...
âš ï¸  Could not fetch primary keys: 002003 (42S02): SQL compilation error:
Object 'SF_TRIAL.INFORMATION_SCHEMA.KEY_COLUMN_USAGE' does not exist or not authorized.
âœ… Metadata cached for all tables

======================================================================
ğŸ” Auditing table: TEST_COLUMN_CHECKS
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
ğŸ”– Table UID: SF_TRIAL.PUBLIC.TEST_COLUMN_CHECKS
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 5 rows
ğŸ“Š Optimized column loading: selecting 11/11 columns
âœ… Loaded 5 rows into memory

============================================================
Auditing: TEST_COLUMN_CHECKS
Total rows in table: 5
============================================================


ğŸ”‘ Potential primary key column(s): CITY_NAME, CITY_WITH_SPACE, CITY_WITH_SUFFIX, STATION_CODE, GENERIC_STRING, VALUE_OK, VALUE_MIN

ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
CITY_NAME                      String          âœ— ERROR      0 (0.0%)        5              
CITY_WITH_SPACE                String          âœ— ERROR      0 (0.0%)        5              
CITY_WITH_SUFFIX               String          âœ“ OK         0 (0.0%)        5              
CITY_WITH_ENDCHAR              String          âœ“ OK         0 (0.0%)        4              
STATION_CODE                   String          âœ“ OK         0 (0.0%)        5              
GENERIC_STRING                 String          âœ— ERROR      0 (0.0%)        5              
VALUE_OK                       Int64           - NO_CHECKS  0 (0.0%)        5              
VALUE_MID                      Int64           - NO_CHECKS  0 (0.0%)        4              
VALUE_MIN                      Int64           - NO_CHECKS  0 (0.0%)        5              
EVENT_DATE                     Date            âœ— ERROR      0 (0.0%)        4              
DELIVERY_DATE                  Date            âœ— ERROR      0 (0.0%)        4              
====================================================================================================


ğŸ’¡ Column Insights:

ğŸ“Š CITY_NAME:
   Top 5 Values:
      â€¢ 'Paris' (1x, 20.0%)
      â€¢ 'paris' (1x, 20.0%)
      â€¢ 'Rome ' (1x, 20.0%)
      â€¢ 'London_tmp' (1x, 20.0%)
      â€¢ 'Tokyo!' (1x, 20.0%)
   Length: min=5, max=10, avg=6.2

ğŸ“Š CITY_WITH_SPACE:
   Top 5 Values:
      â€¢ 'paris' (1x, 20.0%)
      â€¢ 'Tokyo' (1x, 20.0%)
      â€¢ 'Rome ' (1x, 20.0%)
      â€¢ 'Paris' (1x, 20.0%)
      â€¢ 'London' (1x, 20.0%)
   Length: min=5, max=6, avg=5.2

ğŸ“Š CITY_WITH_SUFFIX:
   Top 5 Values:
      â€¢ 'Madrid' (1x, 20.0%)
      â€¢ 'Osaka' (1x, 20.0%)
      â€¢ 'London_tmp' (1x, 20.0%)
      â€¢ 'Paris' (1x, 20.0%)
      â€¢ 'London' (1x, 20.0%)
   Length: min=5, max=10, avg=6.4

ğŸ“Š CITY_WITH_ENDCHAR:
   Top 4 Values:
      â€¢ 'Paris' (2x, 40.0%)
      â€¢ 'Madrid' (1x, 20.0%)
      â€¢ 'Berlin' (1x, 20.0%)
      â€¢ 'Osaka.' (1x, 20.0%)
   Length: min=5, max=6, avg=5.6

ğŸ“Š STATION_CODE:
   Top 5 Values:
      â€¢ 'EF9012' (1x, 20.0%)
      â€¢ 'ZZ9999' (1x, 20.0%)
      â€¢ 'AB1234' (1x, 20.0%)
      â€¢ 'CD5678' (1x, 20.0%)
      â€¢ 'GH3456' (1x, 20.0%)
   Length: min=6, max=6, avg=6.0

ğŸ“Š GENERIC_STRING:
   Top 5 Values:
      â€¢ 'hello' (1x, 20.0%)
      â€¢ 'PARIS' (1x, 20.0%)
      â€¢ 'paris' (1x, 20.0%)
      â€¢ '12345' (1x, 20.0%)
      â€¢ 'abc' (1x, 20.0%)
   Length: min=3, max=5, avg=4.6

ğŸ“Š VALUE_OK:
   Top 5 Values:
      â€¢ '10.0' (1x, 20.0%)
      â€¢ '50.0' (1x, 20.0%)
      â€¢ '0.0' (1x, 20.0%)
      â€¢ '-5.0' (1x, 20.0%)
      â€¢ '101.0' (1x, 20.0%)
   Stats: min=-5.00, max=101.00, mean=31.20, median=10.00
   Quantiles: p25=0.00, p50=10.00, p75=50.00, p90=101.00

ğŸ“Š VALUE_MID:
   Top 4 Values:
      â€¢ '10.0' (2x, 40.0%)
      â€¢ '25.0' (1x, 20.0%)
      â€¢ '99.0' (1x, 20.0%)
      â€¢ '50.0' (1x, 20.0%)
   Stats: min=10.00, max=99.00, mean=38.80, median=25.00
   Quantiles: p25=10.00, p50=25.00, p75=50.00, p90=99.00

ğŸ“Š VALUE_MIN:
   Top 5 Values:
      â€¢ '1.0' (1x, 20.0%)
      â€¢ '5.0' (1x, 20.0%)
      â€¢ '0.0' (1x, 20.0%)
      â€¢ '2.0' (1x, 20.0%)
      â€¢ '3.0' (1x, 20.0%)
   Stats: min=0.00, max=5.00, mean=2.20, median=2.00
   Quantiles: p25=1.00, p50=2.00, p75=3.00, p90=5.00

ğŸ“Š EVENT_DATE:
   Date Range: from 2019-12-31 to 2025-11-07 (2138 days)
   Timezone: None (timezone-naive)
   Most Common Dates:
      â€¢ 2021-01-01 (2x, 40.0%)
      â€¢ 2019-12-31 (1x, 20.0%)
      â€¢ 2025-11-07 (1x, 20.0%)
      â€¢ 2024-06-01 (1x, 20.0%)
   Most Common Days of Week:
      â€¢ Friday (3x, 60.0%)
      â€¢ Saturday (1x, 20.0%)
      â€¢ Tuesday (1x, 20.0%)

ğŸ“Š DELIVERY_DATE:
   Date Range: from 2025-06-01 to 2026-01-02 (215 days)
   Timezone: None (timezone-naive)
   Most Common Dates:
      â€¢ 2025-12-30 (2x, 40.0%)
      â€¢ 2025-06-01 (1x, 20.0%)
      â€¢ 2025-11-12 (1x, 20.0%)
      â€¢ 2026-01-02 (1x, 20.0%)
   Most Common Days of Week:
      â€¢ Tuesday (2x, 40.0%)
      â€¢ Sunday (1x, 20.0%)
      â€¢ Wednesday (1x, 20.0%)
      â€¢ Friday (1x, 20.0%)

ğŸ” Issues Found:

ğŸ“Š Column: CITY_NAME (String)
   Nulls: 0 (0.0%)
   Distinct values: 5
   âš ï¸  TRAILING CHARACTERS (' '): 1 rows (20.0%)
      Examples: ["'Rome '"]
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'paris' â†’ ['Paris', 'paris']

ğŸ“Š Column: CITY_WITH_SPACE (String)
   Nulls: 0 (0.0%)
   Distinct values: 5
   âš ï¸  TRAILING CHARACTERS (' '): 1 rows (20.0%)
      Examples: ["'Rome '"]
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'paris' â†’ ['paris', 'Paris']

ğŸ“Š Column: GENERIC_STRING (String)
   Nulls: 0 (0.0%)
   Distinct values: 5
   âš ï¸  CASE DUPLICATES: 1 unique values with case variations
      'paris' â†’ ['paris', 'PARIS']

ğŸ“Š Column: EVENT_DATE (Date)
   Nulls: 0 (0.0%)
   Distinct values: 4

ğŸ“Š Column: DELIVERY_DATE (Date)
   Nulls: 0 (0.0%)
   Distinct values: 4


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.044s
   â€¢ numeric_checks: 0.001s
   â€¢ date_checks: 0.004s
   â€¢ Total: 0.06s


â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.000s
   â€¢ Metadata: 0.014s
   â€¢ Column Selection: 0.000s
   â€¢ Data Loading: 0.408s
   â€¢ Audit Checks: 0.061s
   â€¢ Total Table Audit: 0.48s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251030_133528/TEST_COLUMN_CHECKS/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251030_133528/TEST_COLUMN_CHECKS/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251030_133528/TEST_COLUMN_CHECKS/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251030_133528/TEST_COLUMN_CHECKS/summary.csv

======================================================================
ğŸ” Auditing table: TEST_JSON
======================================================================
ğŸ” Secure audit mode: Direct database query via Ibis (no file export)
ğŸ”– Table UID: SF_TRIAL.PUBLIC.TEST_JSON
ğŸ“‘ Table type: BASE TABLE
ğŸ“Š Table has 0 rows
ğŸ“Š Optimized column loading: selecting 1/2 columns
âœ… Loaded 0 rows into memory

============================================================
Auditing: TEST_JSON
Total rows in table: 0
============================================================


ğŸ”‘ Potential primary key column(s): NAME

ğŸ“‹ Column Summary (All Columns):
====================================================================================================
Column Name                    Type            Status       Nulls           Distinct       
----------------------------------------------------------------------------------------------------
NAME                           String          - NO_CHECKS  0 (0.0%)        0              
JSON_CONTENT                   VARIANT         - NOT_LOADED N/A             N/A            
====================================================================================================

âœ… No issues found!


â±ï¸  Audit Duration Breakdown:
   â€¢ string_checks: 0.000s
   â€¢ Total: 0.00s


â±ï¸  Table Audit Phase Breakdown:
   â€¢ Connection: 0.000s
   â€¢ Metadata: 0.001s
   â€¢ Column Selection: 0.000s
   â€¢ Data Loading: 0.423s
   â€¢ Audit Checks: 0.000s
   â€¢ Total Table Audit: 0.42s
ğŸ“„ HTML report saved to: audit_results/audit_run_20251030_133528/TEST_JSON/audit.html
ğŸŒ Opened report in browser
ğŸ“„ Results saved to: audit_results/audit_run_20251030_133528/TEST_JSON/audit.json
ğŸ“„ CSV saved to: audit_results/audit_run_20251030_133528/TEST_JSON/audit.csv
ğŸ“„ Column summary CSV saved to: audit_results/audit_run_20251030_133528/TEST_JSON/summary.csv

======================================================================
ğŸ”— Detecting table relationships...
======================================================================
   Added table: TEST_COLUMN_CHECKS
   Added table: TEST_JSON

âœ… Found 0 relationships (confidence >= 70%)

======================================================================
ğŸ“Š Generating run summary reports...
======================================================================
ğŸ“„ Summary HTML saved to: audit_results/audit_run_20251030_133528/summary.html
ğŸŒ Opened summary report in browser
ğŸ“„ Summary JSON saved to: audit_results/audit_run_20251030_133528/summary.json
ğŸ“„ Detailed column summary CSV saved to: audit_results/audit_run_20251030_133528/columns.csv
ğŸ“„ Table summary CSV saved to: audit_results/audit_run_20251030_133528/tables.csv

======================================================================
âœ… Audit completed! Results saved to: audit_results/audit_run_20251030_133528
â±ï¸  Total duration: 29.60 seconds
ğŸ“ Logs saved to: audit_results/audit_run_20251030_133528/audit.log
======================================================================
ğŸ”’ Closed SNOWFLAKE connection
